<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" class="h-full" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D,%22class%22:%7B%22ssr%22:%22h-full%22%7D%7D">
  <head>
    <title>Wyciskamy dane z PDF jak sok z cytryny.  | Precise Lab</title><meta name="gridsome:hash" content="29051e5f392aad1c74a491ba61f8f93896c1d0f3"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.13"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Dane są wszystkim co jest lub może być przetwarzane umysłowo lub komputerowo. Przy obróbce komputerowej niektóre formy ich zapisu są mniej lub bardziej wygodne. Na przykład PDF uznawany jest za formę wygodną dla człowieka, ale często nie doceniamy możliwości maszyn w automatyzacj ..."><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="Wyciskamy dane z PDF jak sok z cytryny."><meta data-vue-tag="ssr" property="og:description" content="Dane są wszystkim co jest lub może być przetwarzane umysłowo lub komputerowo. Przy obróbce komputerowej niektóre formy ich zapisu są mniej lub bardziej wygodne. Na przykład PDF uznawany jest za formę wygodną dla człowieka, ale często nie doceniamy możliwości maszyn w automatyzacj ..."><meta data-vue-tag="ssr" property="og:url" content="https://github.com/gustawdaniel/gustawdaniel.github.io/wyciskamy-dane-z-pdf-jak-sok-z-cytryny/"><meta data-vue-tag="ssr" property="article:published_time" content="2020-05-05"><meta data-vue-tag="ssr" property="og:image" content="https://drive.google.com/uc?export=view&amp;id=1UEsC2SpkDdinS1uKs7mlI7pF2NImcRvy"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="Wyciskamy dane z PDF jak sok z cytryny."><meta data-vue-tag="ssr" name="twitter:description" content="Dane są wszystkim co jest lub może być przetwarzane umysłowo lub komputerowo. Przy obróbce komputerowej niektóre formy ich zapisu są mniej lub bardziej wygodne. Na przykład PDF uznawany jest za formę wygodną dla człowieka, ale często nie doceniamy możliwości maszyn w automatyzacj ..."><meta data-vue-tag="ssr" name="twitter:site" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:creator" content="@cossssmin"><meta data-vue-tag="ssr" name="twitter:image" content="https://drive.google.com/uc?export=view&amp;id=1UEsC2SpkDdinS1uKs7mlI7pF2NImcRvy"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.efcb514c4ed5bb749bbcc0c345bb775e.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:400,700%7CCardo"><link rel="preload" href="/assets/css/8.styles.86fe3995.css" as="style"><link rel="preload" href="/assets/js/app.b21ea3c7.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.7752b335.js" as="script"><link rel="prefetch" href="/assets/js/10.97e20881.js"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.39addc69.js"><link rel="prefetch" href="/assets/js/page--src--pages--about-vue.461a9a27.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.eb768e00.js"><link rel="prefetch" href="/assets/js/page--src--templates--author-vue.62b3dfc0.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.9fcc17b7.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--index-vue~page--src--templates--author-vue~page--src--templates--post-vue~~a0fae544.e56b102d.js"><link rel="prefetch" href="/assets/js/vendors~page--src--templates--post-vue.245a0b70.js"><link rel="stylesheet" href="/assets/css/8.styles.86fe3995.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body class="antialiased font-serif" data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22antialiased%20font-serif%22%7D%7D">
    <div data-server-rendered="true" id="app"><main><header><div class="post-cover overflow-hidden relative max-h-cover"><div class="max-w-xl md:max-w-3xl xl:max-w-4xl text-center px-6 absolute z-10 mx-auto bottom-0 inset-x-0 pb-16"><div class="m-auto"><p class="text-white text-xs mb-2 uppercase">6 min read</p><h1 class="text-3xl sm:text-5xl font-sans font-bold leading-tight mb-2 text-white">Wyciskamy dane z PDF jak sok z cytryny.</h1><p class="text-white"><span><a href="/author/Daniel%20Gustaw/" class="text-white capitalize border-b border-transparent hover:border-white transition-colors duration-300">Daniel Gustaw</a> •
          </span><time datetime="2020-04-06 10:18:38" class="capitalize">06 April, 2020</time></p></div></div><!----></div><nav class="absolute top-0 left-0 z-20 mt-6 ml-6"><a href="/" class="text-sm border opacity-75 hover:opacity-100 rounded-full px-4 py-2 transition-opacity duration-300 active text-white border-white">← Home</a></nav></header><article class="max-w-xl md:max-w-2xl xl:max-w-3xl mx-auto px-6 sm:px-12 pt-16"><!----><div class="markdown text-lg leading-normal text-gray-700 pb-10"><p>Dane są wszystkim co jest lub może być przetwarzane umysłowo lub komputerowo. Przy obróbce komputerowej niektóre formy ich zapisu są mniej lub bardziej wygodne. Na przykład PDF uznawany jest za formę wygodną dla człowieka, ale często nie doceniamy możliwości maszyn w automatyzacji procesów opartych o pliki PDF.</p>
<p>W tym wpisie pokarzemy jak pisząc naprawdę znikome ilości kodu można wygodnie wydobyć dane z plików PDF. Dla przykładu posłużymy się biletami kolejowymi ponieważ nie zawierają żadnych danych objętych tajemnicą, ale równie dobrze mogły to by być faktury, umowy czy pliki CV.</p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 500 353' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-4f49a096543979871aca9052b0da2434'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-4f49a096543979871aca9052b0da2434)' width='500' height='353' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAtAEADASIAAhEBAxEB/8QAHAABAAEFAQEAAAAAAAAAAAAABwYAAgMFCAEE/8QANhAAAQMCBAQBCwIHAAAAAAAAAQIDBAARBQYSIRMxQVEHFBUXIjJSVWFxlOIWoSNjgZGxwdH/xAAaAQACAwEBAAAAAAAAAAAAAAADBQECBgAE/8QAJhEAAQQBAwMEAwAAAAAAAAAAAQIDBBEABRIhBjFBE1FhcYGRwf/aAAwDAQACEQMRAD8A%2bxttbnsJJ%2bleKSUqIIsRsauQ8tpKghVr70uxPDnB34rLrjk4rWhKlEOjmQCelbSTLRGouecw8aGuVYb8YP1VJuZfD2NHh6sHcfMlNzw3lghY22BsLGjRaFNrUhxJStJsUqFiD2NTHlNyRbZyJMR2MQHB3y2qrfZJwqPjWYGocwuBlSFqPDVY3AuN6ST4a4GATebt/PH/AChyJ7UdWxd3hY2nvSUb26rB2MyX5CGgQCo2uavmx0x3AEOcRJ62tY9qkuc8qLwR5UmAXHIIVYkm6mj8z2%2bdRZ15x0JDiyoJ2F%2blGZeS%2bA42eMA8ypgltwUcxH2T9K6KgTmEwIw8pYH8JHNxPuiuekta2lq1AW2t/SvowHw8zTCcXKOCw5XEYIaS9Jb0gqIIURfsDt86Q9QuqR6YSm%2b/8zXdIQGJQeU88EEbaBrm79yO2dAOyYb1uJIYJv0eAo48RcGTMxeG5hTbalONq47iVgi4Itc97VGsUyPmGRBfYi5eiNOO6RxVSGAUJF7pTp6crHn36VH5OXsewNDMLGyuJEUjUyxGkAJcN/WUsoNydxzNrUq0198yQhtNE3ybrt5xt1DpUZrTlvIfSogjji6sciif17WcRco4YxgmMRJsl9LeltTbtz6t1CwIJ5dKUC8SCCsf3FBWRork3GYsFSlOxmELdZYUoqBcvfWok72HIdKWEQpAb0qjpvptqBQevP8AxSvWZ%2boRZZZW0XOL3AGu544BxPoLCDFKisdzx%2bvnNs7HjPlSXUJUleygVbEHntXPuMNIYxecyynS02%2b4hA7AKIH7U1yIEh0FLcZKAVAgak7bcqGMfN8cn8xZ9YP1Bt/qmvSuoyZMhxp1koSBdm6JuvIH3nn6iZQhpCkqs3/M15FwRSRH8TUtR2mjhJUUISm4kWvYW92java2L8VqRQcF1mcjynY5JaNXiZ6UUfCFfc/jUWznmX9SSIrgi%2bTBhCkW4mvVcg9h2qOVc0AXUAi4JFDagsMq3oTRHycI9PkPp9NarB%2bBm1ytjHmLGW5/A4%2bhKk6NWm9xbnapt6UEfCVfc/jRxLbS2%2bpCeQtWKpehsyDvcFn85zM1%2bOnY2aH4xMHiikEHzQr7n8aOp8jyudJklOgvOqc03vbUSbfvWCqtVmIjUcktiryj8x6QAHDdfWf/2Q==' /%3e%3c/svg%3e" width="500" data-srcset="/assets/static/convert-scanned-pdf-to-text.b269a45.e90f10a2c8de80622665b465fa0eb970.jpg 500w" data-sizes="(max-width: 500px) 100vw, 500px" data-src="/assets/static/convert-scanned-pdf-to-text.b269a45.e90f10a2c8de80622665b465fa0eb970.jpg"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/convert-scanned-pdf-to-text.b269a45.e90f10a2c8de80622665b465fa0eb970.jpg" width="500"></noscript></p>
<h2 id="zdobycie-danych"><a href="#zdobycie-danych" aria-hidden="true"><span class="icon icon-link"></span></a>Zdobycie danych</h2>
<p>Przy każdym zakupie biletu z adresu <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">bilet.eic@intercity.pl</code> wysyłany jest do mnie e-mail zawierający bilet. Łatwo mogę wyszukać te e-maile wybierając filtr w poczcie z której korzystam</p>
<code class="shiki" style="background: #2e3440; color: #d8dee9">bilet pkp has:attachment -in:chats from:bilet.eic@intercity.pl to:me </code>
<p>Oto widok jaki widzę po filtrowaniu:</p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1545 916' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-31c99660fb5caa516b7237bc3a4116e8'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-31c99660fb5caa516b7237bc3a4116e8)' width='1545' height='916' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAmCAYAAAB0xJ2ZAAAACXBIWXMAAAsSAAALEgHS3X78AAAHqElEQVRo3tVaa1MURxQdHstzl%2bfyWJCHAQoBQWAtIEEQVAwolrvLrkLwQSql4GshKVOp5AeEqD/6pk/DGe%2b2MxsXU8p%2buHRPz%2b2eme5zzz3di9fdnZD5%2bXmZmpqSZDIpMzOzMjubLDC0TU9P2zI5%2b9Enmbxa4I/6zPSMrV%2b5ckUmJiaMXT61CTPGjFy%2bPGnuTUtTU5N4nvfVLRKJSCwWk%2brqaqmvrxdvaGhYUqm0rK3dlgcPHkomsyXZbM7YA8mZcmsrK%2bl0RjY375lyy7bdN/6ZTNb3Rwk/WCqVseXG%2boYsLl6TpaVla6hjjJWVVfuseLzjm0xANBqVwcFBaWhokK6uLvHq6uqkpaXVrghmprm52ZbR6InFYOaa99HG%2bokVtsNO6s1m3JYCwz2Mj3pNTY19oYqKiq9meiLUtSeJRMI0eBYSFhbfYGX%2bT8OiYlEAd/2xFy5ckN7eXns9Ojp64o%2bL2tpaGxM0rA7KysrKT6yqqkqazOCtra0%2bYuCPMWB4KPqi5DXb2A5/toeZfgc8E6bHQMl21/Q30B/jYGLwTvBB3U4M/iAe0IBOQEBHR4f9MA0b1mvMYK/yefnnwwd5cXAgR0dH0t7eLm1tbbZfPB631%2bjf3d1t64A87nd2dtprlPBFiTgEAtmGiYUPVgol3ocTjXFYZ7jxGrGNUhvaYqeLhe/jt2AS1HXpEFvo65GNyQlJ9A/I1OSkDAwMSE9Pj51ZJ74KJjAoFj/XPqcffUp8RvEBg4ik3lij8iP8zzs3BC4AGgAHHQKAI%2bAWNJMRE1OZ7R05yB%2balJiV3d1dCzGYDgH0B7TRDjjqEAHsGQIIE4YADP7wAWGFhQAzSikhwKzDBVNk7/mEQqIDaRDOQZa5viTPM2mZX1yUjY0N%2b0F4CMmUJEUiwlhh5Ic23a4JVJMgCS2M%2bOCnidwlRZfP4F8yB3CQdqSUSDXgI3XmRUlyZ43vb2oMAb1qyApYAU0qrMNnzqz82p078v3Cgixeu%2baHEODGOqyxsdG2AW6EHcYmdDW8Kaxwn3BGqVFCruH7sU3f136s4zka0US5jwAOgI9DB6xmmFavMJ2f7GzLH7/9KtlcTp4%2beWJTFnkDfREOeHk8WKs/xDZKxijuwxd92M4YR/xzQjEW4xklJkBPLkpe09iHuV9B3ueB0kPgtByOVMpUU6N4kRqrC0BiILMyVY5eAQGSsEgcQRaHUDF5HysKNifMdCgxnLQ61O1EnEuCrlG5uaTmqsGgui6JABKgHxLFlGDYdvLlmzdy/P69HOzvWyXINMgUCAP0qfIAcaZBKkHtA/TgHozw51gQWIA3eYEhRaiTK9AOv6BUCNNpkDx35hCYS3TJj2Oj0tHTK%2bNjYzI%2bPi59fX1FU%2bc5zhBnU4INzu6rrJUg49dVgkGD1Jj8//DxY8m//V1%2b2tmRp3t7FmoIAcAZ0IVhDJS4hzDAPdQBU6pDGmENqOK5KOGjMwYMsGXGYEgwA3BMhoU7tkp7drHQJ5AEqajctKHt/g8L8su9uzI7Nye3bt60aRAfiwl0yUqrOE20fKZLwLpdX8OwWO67FhtH33OR8EVKsBWHKJEqn1Co8cteCVJ1AR7%2bgYETO9gMLa6symY6I9eXl2X1xg1/fw24AabMKrgGXDkeBQyhybre3KCN/QBnrey0wiTvaGMb/dgOf40Cfqc/AW5e5mlPmBLczWXlrUmFqXRaHj16ZHdujHHGrk5b/CAelHw8d4z654X0ZT%2bqSX4AlR5KTiTVJkpXCbIP7qPUIe2fCJ81DX5X5clE1AxQHZGYeTgmoOyVoCYMouGTNHi6kcBq9/f3%2b3t5KjZ3g8KwIhy5zXZVoasUi5n212rwv/oRAXrbHKoEmb4ClaDp%2bPL1azl%2b9072nz%2bXw8NDf0MDMuRmiEoOsGZKJEe4Bxp6A8NUqcOChr6aP/QOkpzhHozwSJ8fjEmD/xeFwNXOuNwaGZJ4okdGhodlZGTEKkF/VsstBMLSV5gSrDtVg5pVtdAoGxUYpAT5k1G4EozI7t7P8vbPv%2bSxyQDPnj3zNzs82ua%2bH3WKJIQDzwJh4A%2bqR/RDf5Apt9bwx7to1ah/XdKl/vXJPQ/Es1Hn%2b/NApmAzRALkLPE6bDY3567K3vptmUomZXlpyRIiHsQfIFxVps/1SlFwVGy6rtuCrvV36D5FjudLV4LNxrqqP04QSa6slSDTC9IVBUaYElxZuy2Zh9t2H7C%2bvu6nPrIwBQ0VG5kZYzLT0ChWqN60j26D4f3Yh%2b1MufTXSlCPQYLWytJHgD6ShgOVXPCMVcp2KiVHB/ty5%2b5dyeVy9tACcYs4pgpjTPIAk6pOn%2bHx4/VEsNTnelR%2bWldQsnMytEpkP92XUlgfsp45DQ5UeDLWUOu3kbTKUgkC2u55GlVbUAoEqfQath4y%2bR%2b5HwRIWGkIajVIOFIJhv0wotVd0PkgVar7Q4oeU/8irMciqetnhCpBKrigGUPHFy9fyd/HxzYF5vP5AiXIzRB/MQY0mQKp2vSZHqFOCOtdolaLKN0dpj4m1xssrR5dJajD7MwhMNPWIisXByRmPuzi4KBcunTJIqFY6jzXIfC5VnnyDwXSZJDSXGfCBNA/hSRPg3TudXPxeTNMwL%2bEA3sNlqnJPgAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="1545" data-srcset="/assets/static/gmail.82a2fbd.20936fbe29acef6f55aa2c681bb76249.png 480w, /assets/static/gmail.cbab2cf.20936fbe29acef6f55aa2c681bb76249.png 1024w, /assets/static/gmail.52e709e.20936fbe29acef6f55aa2c681bb76249.png 1545w" data-sizes="(max-width: 1545px) 100vw, 1545px" data-src="/assets/static/gmail.52e709e.20936fbe29acef6f55aa2c681bb76249.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/gmail.52e709e.20936fbe29acef6f55aa2c681bb76249.png" width="1545"></noscript></p>
<p>Teraz wystarczyło pobrać pliki aby móc poddać je obróbce.</p>
<p>Wszystkie załączniki zapisałem na dysku twardym w katalogu ocr. Tak jak w każdym z wpisów na tym blogu dalsze operacje będą wykonywane na systemie Ubuntu.</p>
<h2 id="przetworzenie-pdf-do-postaci-tekstu"><a href="#przetworzenie-pdf-do-postaci-tekstu" aria-hidden="true"><span class="icon icon-link"></span></a>Przetworzenie PDF do postaci tekstu</h2>
<p>Zaczniemy od ustalenia początkowej zawartości katalogu. Jest wypełniony pikamy PDF.</p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 829 62' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-aa5c658ec41cd91e5e192e4b11d8374c'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-aa5c658ec41cd91e5e192e4b11d8374c)' width='829' height='62' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAFCAYAAAD1/OoBAAAACXBIWXMAAAsSAAALEgHS3X78AAAC2ElEQVQ4y21Ua4/TMBCs6DVN2jTvl/OOnde1qY5KCHEH6JAQ/Aj%2b//8Ydl1awYkPlt3dnfXMrJtVMYTIew/l5GP4ENPuQUgH%2beCh6ANEhaNzovNRP4aIKwf1HCEtA4oHKGYH7TmEH7g4eCHcpIQfCwRJDp/OthfB80NYpok4jmEYG7xbr7H%2bswzDgEk5XtvtFrZ9wOFwwH6/h02773nY7XawLFPXcs3fi2P/i7/Nv615eHiA67pYqY8ehmcfx9cYz78Elp8xHr%2bGGD8HqBcHqbJx%2bpZg%2bRHh8dUnwS6O30k8Ce8uAZbvCYYXH3FKRsoTuuUT2uUF/fsv%2bizUgqqV2JGAumkQhsGdjGVZJG5/J2rbto5tNpw378Q5xgaxKbczYzabjY6xQTcjbwJvpnLuaqD1D4ZzjuNgFYcJ0rhA10iM/RGqHaC6EYMcIVKBjn5PwwzLMOG5MeV6xEFKk4nQVA2SUCDR%2bBp5niNLI1RVjWkcYaxXdJmNtm1o%2bhGJj9EriX4YME4T5nnGRHuRZ2g7hdPpBNex4Xr0Goee%2bgkIUeDp6Ql931MNcSQs48oiR9N0hFmIC70ax9U1HE%2bSFOfzGUopfV8nJS6XC%2bqqRFW3GhMGnjZ8lWWpngyDFRWP40AXtURSIRcZGprePE%2bw9xb8MISUHZHKIEjsQLVlWUDyJV2nexREoCZi3Me2d3BITEv9kySmRULJqEwI1DUZVhQaI4gDE2NhbACL4X7XewoifCRDBo0tydy2bZGmCRndaIzvOdjTX4fjbFqaZjgeGTNCdo3uwWbkZHRRVpgIczegIBJMhqeid3aaGjGAxal%2bQENxyzQQRrHOMaaiGJPkqXNtQyIVOc0EGMN1O2uLIIjoFbVEvCRBQuf5W8AmMOZGWqrrvfudqV8Av5qyLLVJPHU2oOv47vJqHuGl7DUHHg6bxkZrDAnmetYiiRO/SObMQ5BSEUbiQMPhb81v8zuZ5bql1VgAAAAASUVORK5CYII=' /%3e%3c/svg%3e" width="829" data-srcset="/assets/static/text.82a2fbd.2e459a2026d46776c59c21eb796ae9f6.png 480w, /assets/static/text.21228ac.2e459a2026d46776c59c21eb796ae9f6.png 829w" data-sizes="(max-width: 829px) 100vw, 829px" data-src="/assets/static/text.21228ac.2e459a2026d46776c59c21eb796ae9f6.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/text.21228ac.2e459a2026d46776c59c21eb796ae9f6.png" width="829"></noscript></p>
<p>Dzięki narzędziu <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">pdftotext</code> z pakietu <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">poppler-utils</code> możemy wydobyć z plików PDF interesujące nas informacje w postaci czystego tekstu. Następującym poleceniem możemy zainstalować to narzędzie:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">sudo apt-get install poppler-utils</span></code></pre>
<p>Aby go użyć korzystamy ze składni</p>
<code class="shiki" style="background: #2e3440; color: #d8dee9">pdftotext {PDF-file} {text-file}</code>
<p>W naszym przypadku mamy wiele plików wejściowych i wyjściowych dlatego skorzystamy z <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">xargs</code>.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">ls eic_</span><span style="color: #D32F2F">*</span><span style="color: #24292EFF">.pdf </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> xargs -i pdftotext </span><span style="color: #22863A">"{}"</span><span style="color: #D32F2F">;</span></code></pre>
<p>Polecenie to składa się z dwóch części. W pierwszej listuję wszystkie pliki zaczynające się od <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">eic</code> i kończące się na <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">.pdf</code>. Następnie używając programu <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">xargs</code> wynik przechwytywany jako strumień danych przekazuję linia po linii do polecenia <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">pdftotext</code>. Brak drugiego argumentu oznacza, że w moim przypadku powstały pliki tekstowe o takich samych nazwach jak pliki <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">pdf</code>.</p>
<p>Łatwo sprawdzimy czy faktycznie istnieją dzięki poleceniu <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">ls</code></p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 836 63' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-f1513d2db6bc64c87b3c6e191e5ec491'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-f1513d2db6bc64c87b3c6e191e5ec491)' width='836' height='63' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAFCAYAAAD1/OoBAAAACXBIWXMAAAsSAAALEgHS3X78AAAC2klEQVQ4y11UyY7bMAzNoM2eyKu8yJtseck6SaYTTKeHAkWv/f/feSWV8aDogbAo8nF5pDypbgL5XkANAsVZoP/pQ98cqN0WGd/3W3jJimwO6Vuo4wp%2bMYM0C7pfIuk3yI5r5IcNhLuBn2gkVQ/VnEgOiIsWUW6glILnupBSYrvdWt0l3fc9OI6DKIqRJAm2mzVWqzXm8zlmsxmEcEhfYjqdkUyxXC6tsG30%2bfe8WlF9vo/FYmH9GDP6/C9snxx%2bSfTfuWkXu/cIL39SnH9HaO8hhncJffWQNi66txDmTaB%2bFSjPLsqrQErk1NcA3Y8AA9ljFSMzZ1S7b%2bhvP9EcX5F3F6R6h7IsbGF5UdhG27ZFlmWI49jeZ3mOutZwHfHZ6Hq9/mxqs9lY4TsWvht9%2bDz6jefxfsSxjHa2jUROdN4idGPEUqHMaxjdoW/2qMsWph4gPYmi0NB5g6fJV4iNRzYDsXLhCp8wGlGgoJISTV1Da43QJ4Ko0boq8eVpgjiStuEgCNA0xpLR9T32%2bz0ul4vFsY2xbOMGyqqymDCkQQw7PD8/W3vbdTgej9BkT9MEHekZbdOUME3TEImPWIzh%2bJyP5Xq92jxpmqKn3BHVxFszMaaxE8lpAhysrg0lOBCoJp1WmQBZVljwcrmgdXUfScLHNI1pqWgqjL5c8G4YbLxKExlEwHy%2bID21xXmeR76lnTQ3wzmNeRDCz4HjFkVu1/2xEbUlwFDc0%2blkfRlbU6ycticIpb1jIpiAikjh%2bIzp%2boEwR3B/1QeZSqV24wzh%2bSky0ZOsSCGjEGlGhl0F3eXQDa0pBS20QpJLqCpGZRRm0zl86UHliW0miiLoPkPVKcJlSBVhyooKkDZBqjL7FlnndX%2b53XC/3%2b2b57XnpnkiPA3%2bL3BxYRjYwiTFHp8H/y8KIpu/TG7EfjRljsM618LTjOPE1mSfFOVjgjk%2b%2bySEcV0HzkdORwiL%2bQsutJlw9qS8yQAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="836" data-srcset="/assets/static/text2.82a2fbd.718e0b6de02a6f743697b960d7b7d40c.png 480w, /assets/static/text2.7900e78.718e0b6de02a6f743697b960d7b7d40c.png 836w" data-sizes="(max-width: 836px) 100vw, 836px" data-src="/assets/static/text2.7900e78.718e0b6de02a6f743697b960d7b7d40c.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/text2.7900e78.718e0b6de02a6f743697b960d7b7d40c.png" width="836"></noscript></p>
<h2 id="strukturyzacja-danych"><a href="#strukturyzacja-danych" aria-hidden="true"><span class="icon icon-link"></span></a>Strukturyzacja danych</h2>
<p>Na początek zaczniemy od czegoś prostego. Załóżmy, że chcemy policzyć ile pieniędzy łącznie wydałem na bilety, ale nie będziemy sprawdzali tego na każdym bilecie po kolei ręcznie - od tego jest komputer. Poza tym gdy dostaniemy inny zestaw biletów ręczną robotę musieli byśmy powtarzać. Może Cię to zaskoczyć, ale aby wykonać to zadanie nie trzeba nawet edytora kodu i napisaliśmy to w jednej linii:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">ls eic_</span><span style="color: #D32F2F">*</span><span style="color: #24292EFF">.txt </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> xargs -i cat </span><span style="color: #22863A">"{}"</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> perl -ne </span><span style="color: #22863A">'if(/SUMA PLN: (.*) zł/){print "$1\n";}'</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> tr , </span><span style="color: #1976D2">.</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> paste -sd+ </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> bc</span></code></pre>
<p>Ta linia zwróciła <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">786.11</code> czyli koszt wszystkich biletów.</p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 832 58' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-86867d7541f3a5b0c3a4254efb0c35aa'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-86867d7541f3a5b0c3a4254efb0c35aa)' width='832' height='58' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAECAYAAAA%2boDmkAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8klEQVQ4y61T23LaQAw1V9/wBa93bbDBNzDQ4CQtzUM7feAHmPz/15xKC4ZMJn3rwxmtVjqSjrw2urcD9r8Uyk5i85Ji%2b5Zg/0eg/i5QHGPULxIy89FQrOwi7H4rZJs5xQTWhwhq5aN6jbE5KSRLgTSrsNo8oXn6iXxzRFYfsCxbZFkGz/MgpUIQBNpfLjMoKZEkCeqmQaIk5kKQTbAuCp3Tti3FFVzXhU88QfGc7l3Xge8HSIlr2zY830dI8YJ4Iop0L77XfWczOI6DOI41lFI673T6AaPrXlHkDQJPoKm2dK5hjRxEgUToRZBRgiiSqNY14ijFalGgLrdI5ALlqqKcELbpoSq2WOc58jyjAeZIlYBlmgj8GcQ8uolw9CCWZdHwPmKV4tt%2bh4bEV1UF17EhYoXn506LYVERcdtdC9syMZlMNEajEabT6R2m%2bThzjHP0/c3vY%2bPxWMeGw6Fe0Pl8htHu9tTwSBtZQ6UkMF9gSgVt29KFrzD1nWVfLRfiIuPJ%2bNZ0SP7g0ZgE8vbZWmyZP73WYfEM9geDAQzDuKPP03VuuR%2b5Gjf%2b3f%2bEz7GvfJ5f0st7f3%2bHUdLmeRthGOonFdDWPzZ7EB8FeEA%2bs0jeMIOLsv1quF5wTi8kpSX3Inte/2X%2bJep/ol8A/wqXywV/AVxfLlp02C3eAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="832" data-srcset="/assets/static/sum.82a2fbd.35b09039977489a065a7bdbf404fb4ab.png 480w, /assets/static/sum.288616b.35b09039977489a065a7bdbf404fb4ab.png 832w" data-sizes="(max-width: 832px) 100vw, 832px" data-src="/assets/static/sum.288616b.35b09039977489a065a7bdbf404fb4ab.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/sum.288616b.35b09039977489a065a7bdbf404fb4ab.png" width="832"></noscript></p>
<p>Wejdziemy teraz głębiej i zobaczmy co się za tym kryje. Wyświetlimy jeden z plików tekstowych poleceniem <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">cat eic_67584344.txt</code>:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">BILET INTERNETOWYTANIOMIASTOWY</span>

<span style="color: #22863A">"PKP Intercity"</span>
<span style="color: #24292EFF">Spółka Akcyjna</span>

<span style="color: #24292EFF">OF: 503</span>

<span style="color: #24292EFF">NORMAL. </span><span style="color: #1976D2">:</span><span style="color: #24292EFF"> 1</span>
<span style="color: #24292EFF">ULG. </span><span style="color: #1976D2">:</span>
<span style="color: #24292EFF">X </span><span style="color: #1976D2">:</span><span style="color: #24292EFF"> X</span>

<span style="color: #24292EFF">Przewoźnik: PKP IC</span>
<span style="color: #24292EFF">A-Cena bazowa: 1xNormal</span>

<span style="color: #24292EFF">¦ ¸</span>

<span style="color: #24292EFF">Od/From</span>

<span style="color: #24292EFF">27.09 05:50 Iława Gł.</span>
<span style="color: #D32F2F">*</span>
<span style="color: #D32F2F">*</span>
<span style="color: #D32F2F">*</span>
<span style="color: #24292EFF">PRZEZ: Działdowo </span><span style="color: #D32F2F">*</span><span style="color: #24292EFF"> Nasielsk</span>

<span style="color: #24292EFF">Do/To</span>

<span style="color: #24292EFF">¦ ¸</span>

<span style="color: #24292EFF">KL./CL.</span>

<span style="color: #24292EFF">Warszawa C.</span>
<span style="color: #D32F2F">*</span>

<span style="color: #24292EFF">27.09 07:50</span>
<span style="color: #D32F2F">*</span>
<span style="color: #D32F2F">*</span>

<span style="color: #24292EFF">2</span>
<span style="color: #D32F2F">*</span>

<span style="color: #24292EFF">SUMA PLN: 39,90 zł</span>
<span style="color: #24292EFF">519836278964</span>

<span style="color: #24292EFF">Nr transakcji:</span>

<span style="color: #24292EFF">Informacje o podróży:</span>
<span style="color: #24292EFF">Stacja</span>
<span style="color: #24292EFF">Data Godzina</span>
<span style="color: #24292EFF">Iława Gł.</span>
<span style="color: #24292EFF">27.09 05:50</span>
<span style="color: #24292EFF">Warszawa C.</span>
<span style="color: #24292EFF">27.09 07:50</span>

<span style="color: #24292EFF">/Wagon K m</span>
<span style="color: #24292EFF">IC 5324</span>
<span style="color: #24292EFF">208</span>
<span style="color: #24292EFF">5</span>

<span style="color: #24292EFF">eIC67584344</span>

<span style="color: #24292EFF">Nr miejsca (o-okno ś-środek k-korytarz) Suma PLN</span>
<span style="color: #24292EFF">81 o</span>
<span style="color: #24292EFF">39,90 zł</span>
<span style="color: #24292EFF">1 m. </span><span style="color: #D32F2F">do</span><span style="color: #24292EFF"> siedzenia</span><span style="color: #D32F2F">;</span><span style="color: #24292EFF"> wagon bez przedziałów</span>

<span style="color: #24292EFF">d9U</span>
<span style="color: #24292EFF">Podróżny:</span>
<span style="color: #24292EFF">PTU</span>
<span style="color: #24292EFF">8%</span>

<span style="color: #24292EFF">Suma PLN Płatność: przelewem</span>
<span style="color: #24292EFF">39,90 Zapłacono i wystawiono dnia:</span>
<span style="color: #24292EFF">2018-09-26 09:01:20(52245592)</span>

<span style="color: #24292EFF">Ogółem PLN:</span>

<span style="color: #24292EFF">39,90</span>

<span style="color: #24292EFF">Niniejszy bilet internetowy nie jest fakturą VAT.</span>
<span style="color: #24292EFF">W związku z przeprowadzanymi modernizacjami sieci kolejowej, uprzejmie prosimy o</span>
<span style="color: #24292EFF">dokładne sprawdzanie rozkładu jazdy pociągów przed podróżą.</span>

<span style="color: #24292EFF">Data wydruku: 2018-09-26 09:01:57</span>

<span style="color: #24292EFF">5324</span>

<span style="color: #24292EFF">Bilet internetowy jest biletem imiennym i jest ważny:</span>
<span style="color: #24292EFF">a) wraz z dokumentem ze zdjęciem potwierdzającym tożsamość Podróżnego,</span>
<span style="color: #24292EFF">b) tylko w dniu, relacji, pociągu, wagonie i na miejsce na nim oznaczone.</span>

<span style="color: #24292EFF">Zwrotu należności za niewykorzystany bilet dokonuje się na podstawie wniosku</span>
<span style="color: #24292EFF">złożonego przez płatnika w wyznaczonych przez </span><span style="color: #22863A">'PKP Intercity'</span><span style="color: #24292EFF"> S.A. punktach, z</span>
<span style="color: #24292EFF">wyjątkiem należności zwracanych automatycznie na zasadach określonych w</span>
<span style="color: #24292EFF">Regulaminie e-IC.</span>

<span style="color: #24292EFF">Daniel Gustaw</span>

<span style="color: #24292EFF">d9U</span>

<span style="color: #24292EFF">Informacja o cenie</span>
<span style="color: #24292EFF">Opłata za przejazd:</span>

<span style="color: #24292EFF">(P24) 7219</span></code></pre>
<p>Pierwsze co się nasuwa to, że plik zawiera wszystkie informacje w formie nienaruszonej. Nie ma żadnych literówek, błędów, przestawień jakie typowe są dla systemów OCR wykonujących analogiczną pracę na skanach dokumentów. Cena <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">39,90 zł</code> powtarza się tu w kilku liniach. Czasami występuje razem z <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">zł</code>, czasami nie, może się zdarzyć, że układ linii będzie inny jeśli na bilecie będzie jechało kilka osób. Szukamy najbardziej wiarygodnego wzorca. Jest nim <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">SUMA PLN: 39,90 zł</code>. Teraz chcemy wyłowić z tego pliku właśnie <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">39,90</code>. Posłuży nam do tego <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">perl</code> - język stworzony przez lingwistę Larrego Walla właśnie w celu pracy z plikami tekstowymi.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">$ cat eic_67584344.txt </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> perl -ne </span><span style="color: #22863A">'if(/SUMA PLN: (.*) zł/){print "$1\n";}'</span>
<span style="color: #24292EFF">39,90</span></code></pre>
<p>Polecenie to można wytłumaczyć następująco: </p>
<ul>
<li>weź plik <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">eic_67584344.txt</code></li>
<li>całą jego zawartość przekieruj do programu który napisaliśmy w <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">perl</code> jako wejście</li>
<li>program na każdej linii tekstu wykonuje to samo polecenie</li>
<li>sprawdza czy tekst pasuje do wzorca zaczynającego się od <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">SUMA PLN:</code> i kończącego na <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">zł</code>. </li>
<li>jeśli tak, to wycina wartość między tymi ciągami znakowymi i ją zwraca</li>
</ul>
<p>Problem jaki mamy to polski <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">,</code> zamiast ogólnie stosowanej na świecie <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">.</code>. Ten problem bardzo łatwo eliminujemy poleceniem <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">tr</code> które zamienia swój pierwszy argument na drugi.</p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 835 61' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-cf58d2b2e6dd1e947cfc9ee7c1af1143'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-cf58d2b2e6dd1e947cfc9ee7c1af1143)' width='835' height='61' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAFCAYAAAD1/OoBAAAACXBIWXMAAAsSAAALEgHS3X78AAACU0lEQVQ4y81TyXabQBDUAgMSMMyAALEPEvIiS7JfbCeXJJf8/zdVukfLc3zyMYd69Fp0lcRk%2bBaje5YYXiXufmvc/1LoX%2bS59hYjqRZoj9LWbP0k0RwiNE8Sqy7A9ofC5nsMc9SQKsfaPKDZPaMejyiHR8IeZX%2bHuq4QRRGMMcizDDpJMQwGKo6RrjKKB4zjSP0Bfd9jQ7nWGmVZom07xDKEpNmMdg31mgtfSOh7g0QrBGGInvibpqG9Nfquw%2bFwRJ5nKNZry9u1Dc1FNK%2bhlMLk7p0Ijyk2zys8/cnx8DPD5iWFOWm0T4oEaHQHje1ranvdngw7JGj2EllHgl4SbN8SEiyJWCFvd2TCI8z%2bHSWZwXFWGTp8hZheyEfwyzlmcXme2%2bOKokBLB/PxdV2j61qkSYKM%2blVFYsMAUsZYr0s7lyYaQbAkBDTfUC%2bCEB7xFViRoczHPGwsG6AuZlaEIAiREHcUhZiYdoNUk%2bh%2bxNbcI9NrmG4H0xi4c48IRozDDkM3QgYaVdEgVRmcqYCOUySqQJXXcB0fy%2bUCvicwm04s5rMp5tfnfA7XdTGbzeA4jgXHQgiIS/0zeIb3OOZdxjknPupda9dZ5uL%2bR/7pdHqrXXl55zzjYpLnKxxPJ9RVCX/hwyMBnu9ZuMK1pFxncZwvl0ubC4pv8955xvc59yAI9inELefYuRz9T48NuMSf8bF3jb%2bSf7XHmCgVo2lrpFkMx3WwCC7H%2bQKL0CNh4ua08M514Z6Xbe0DmRXnL%2bxLXVfYmHesiWQO/935u77%2bWv8D/gK9QHg6RWo4dQAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="835" data-srcset="/assets/static/tr.82a2fbd.1c01d5314aea10830da0b409d1c65dd0.png 480w, /assets/static/tr.1bb425a.1c01d5314aea10830da0b409d1c65dd0.png 835w" data-sizes="(max-width: 835px) 100vw, 835px" data-src="/assets/static/tr.1bb425a.1c01d5314aea10830da0b409d1c65dd0.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/tr.1bb425a.1c01d5314aea10830da0b409d1c65dd0.png" width="835"></noscript></p>
<p>Nie będziemy oczywiście powtarzać tych poleceń dla każdego pliku osobno. Zamiast tego ponownie wykorzystamy znany już <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">xargs</code> </p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">$ ls eic_</span><span style="color: #D32F2F">*</span><span style="color: #24292EFF">.txt </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> xargs -i cat </span><span style="color: #22863A">"{}"</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> perl -ne </span><span style="color: #22863A">'if(/SUMA PLN: (.*) zł/){print "$1\n";}'</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> tr , </span><span style="color: #1976D2">.</span>
<span style="color: #24292EFF">39.90</span>
<span style="color: #24292EFF">63.00</span>
<span style="color: #24292EFF">15.14</span>
<span style="color: #24292EFF">55.00</span>
<span style="color: #24292EFF">60.00</span>
<span style="color: #24292EFF">186.00</span>
<span style="color: #24292EFF">70.56</span>
<span style="color: #24292EFF">89.40</span>
<span style="color: #24292EFF">139.00</span>
<span style="color: #24292EFF">68.11</span></code></pre>
<p>Pozwolił nam na przeszukanie plików tekstowych za pomocą zdefiniowanych filtrów plik po pliku. Z ciekawszych rzeczy to wykorzystane <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">&quot;{}&quot;</code> oznacza argument który wszedł do <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">xargs</code>.</p>
<p>Zostało już tylko sumowanie, ale suma kolumn z pliku tekstowego to bułka z masłem w konsoli <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">bash</code>. W przypadku jednej kolumny nie trzeba nawet uruchamiać <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">awk</code> - zaawansowanego programu do przetwarzania tekstów. Wystarczy nam <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">paste</code> - program do łączenia plików i <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">bc</code> prosty program do liczenia sum.</p>
<p>Za pomocą <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">paste</code> z opcją <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">-s</code> wykonamy transpozycję do jednej linii. Opcją <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">d</code> ustawimy separator. Będzie nim oczywiście znak dodawania <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">+</code>. Wynik wygląda miej więcej tak:</p>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 833 56' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-3b21b9bc9d681707b8f67f51eedc44a0'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-3b21b9bc9d681707b8f67f51eedc44a0)' width='833' height='56' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAECAYAAAA%2boDmkAAAACXBIWXMAAAsSAAALEgHS3X78AAACXklEQVQ4y6VS2Y7bMAwMNvE6iQ/Jjm/Zlu8jxwbYpgsUKNqi6B/0/79lSnG3QN/7QMikSHpmNJvhrrD%2b8tE%2bBJqHh%2bm7xON3gumrxPBFov8ikHYOqruH/k1g/CZRXl3oVw/13UU%2bu1h/hlh%2bCMRKIMxa1Otn1MsrxSdUFHl7hipLnE4nKKUQhCH6ruNcSokgCFDXGkWewxM%2bjvsDtNbQTYO%2b7%2bF5HveF1B8nCYaPWpYX3GfuBIUUEtM8ozT/CCQc18U4TfA9l2e7rkdZKjR0TuPAezbTdcDyUKimGMNNob9lqC4C1Rqi6AM0awIZEeEpgz7HWN8UVBfRdwI9JwgTD%2bUQobsoAhQhLWrk9YBmviOteiSqRV51SOIYh8OBwboELMsypFmOJIn525CVRF4GIQuRU4Thu2DH44FnHcdhsWLatbdtqr/nz8/PONKd7/k8J3yf%2b/f7PQtm5m17DyEEh8GQUH0cR2zGcUFDAIUXoG8HVErDsT0E4oRQRhxRRGQrjfiUQpct5nFFlioM3ciquw65R/fUU6EoDPAAeRIRMAuBFDgZUlT3iLghb8CZF0uzAgu9mAHSkADC9whwiuv1wiR22x0sy2KCNhG2rB12ux222y3XzJ3J//1%2benri0%2bQmTM47Pu7/9hgME7ljUzct2axDmqa4nFc0bUOABqSk5MvtgpqANbpmUprOtmsJLImRJrxgHAacr1fUVcl2nalW6RZ3muWdtxeyWvdu6bpGRVafibQhrusKuSqZsHHINC9s0bYlkacRy3omkVt6rRSqKGAxWZsJ/08YQcxDGPx/AGMLRAnC7R3UAAAAAElFTkSuQmCC' /%3e%3c/svg%3e" width="833" data-srcset="/assets/static/paste.82a2fbd.d34fb7f1b5e87ac18856a783aa3399e7.png 480w, /assets/static/paste.8bc9b97.d34fb7f1b5e87ac18856a783aa3399e7.png 833w" data-sizes="(max-width: 833px) 100vw, 833px" data-src="/assets/static/paste.8bc9b97.d34fb7f1b5e87ac18856a783aa3399e7.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/paste.8bc9b97.d34fb7f1b5e87ac18856a783aa3399e7.png" width="833"></noscript></p>
<p>Ostatnia cegiełka <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">bc</code> kończy zadanie, ale to było prezentowane na samym początku:</p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">$ ls eic_</span><span style="color: #D32F2F">*</span><span style="color: #24292EFF">.txt </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> xargs -i cat </span><span style="color: #22863A">"{}"</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> perl -ne </span><span style="color: #22863A">'if(/SUMA PLN: (.*) zł/){print "$1\n";}'</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> tr , </span><span style="color: #1976D2">.</span><span style="color: #24292EFF"> </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> paste -sd+ </span><span style="color: #D32F2F">|</span><span style="color: #24292EFF"> bc</span>
<span style="color: #24292EFF">786.11</span></code></pre>
<h2 id="wizualizacja-wyników"><a href="#wizualizacja-wynik%C3%B3w" aria-hidden="true"><span class="icon icon-link"></span></a>Wizualizacja wyników</h2>
<p>Ponieważ pliki ułożone są chronologicznie wyświetlimy łatwo będzie nam zobaczyć wykres kolejnych cen. W tym celu pobieramy <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">chart</code> - paczkę napisaną w <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">go</code> służącą do tworzenia wykresów.</p>
<pre class="shiki" style="background-color: #ffffff"><code><span style="color: #24292EFF">wget https://github.com/marianogappa/chart/releases/download/v3.0.0/chart_3.0.0_linux_amd64.tar.gz -O /tmp/chart.tar.gz</span></code></pre>
<p>I rozpakowujemy </p>
<code class="shiki" style="background: #2e3440; color: #d8dee9">tar -xvf /tmp/chart.tar.gz --directory /usr/local/bin</code>
<p>Kolejna komenda, dodaje numery kolumn <code class="shiki-inline" style="background: #2e3440; color: #d8dee9">cat -n</code> i rysuje wykres</p>
<code class="shiki" style="background: #2e3440; color: #d8dee9">ls eic_*.txt | xargs -i cat &quot;{}&quot; | perl -ne &#039;if(/SUMA PLN: (.*) zł/){print &quot;$1\n&quot;;}&#039; | tr , . | cat -n | chart line</code>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1299 665' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-8252311b3dd6dfc82cd32e36e13fdeb4'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-8252311b3dd6dfc82cd32e36e13fdeb4)' width='1299' height='665' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAhCAYAAABpwa0hAAAACXBIWXMAAAsSAAALEgHS3X78AAAEpUlEQVRo3uVZh47bMAzN/39bgRYtum%2bPjLv2spetUT5aVGVFcuLLOrQGBA9ZNEW9xyF3ptOp1VpbY8x/1XDg3JnP57YsSzZCqimlWj3f1pdtpEwbeVB%2bHx28AXAhAuMjtFaqL3c0jcn16fXKGlqIQ8lr/FZogMlkYouiOBkCNvroHmoW79/Z8mnA16dAoTfAarViCuS4kvMPTX6jacxGHxRZLqy6vrTq4a66P6IO0rc3BURIm74NeeKMBn2rpxOr%2bz1ryCeFfa3k7dC3YYDRaHReCsCZ3VxZqKRGQ6t6j3x9Mgqs1%2bvzUQATnYxp5bt/uX93Y41WNSr8mxRwZ00rbmbTasJoz0/WDF/q77SlgPiWzJgNCgAFJ6cAFKFrhr/EdDxbLa0iFIQ0aKWDiyolGVGD2pn8whsAQtBOQYFaHyYIJZ/6fpVFMY1osFh4GuysA%2b4xhmhVfPpgFVGLJxq9d34KCLQf7zkE%2bj5RbDyyetDzcG5DKYPUnlDFBoY/mc/q/bEBhsPh6SkAJeib6vbaQz0ew9Rwz7bqgDPkUAhVlz8raiGqUI6jri82osrZKcCr/%2buZWxLm6EduQGGRrzP68RiZDAx6%2bcMapSr5zhfwdxyahAoHo0BbeoQw1/e31pCTyn3L0OrBFzTKc5y3QACtvJcXVX2akGaWyzdAAaANCizmnPbGnr42DvMiI2lyhirlyR3M%2bQzYk0zt7n1UEWpAhku2hFbeAPLxk1DArZimoke7WJ8bY4MooeP6QJAGjl8Q7GezikqBDC9PEAdKIcdwRqhRQAxwEgo4SNroneS3MBE4yvhd8uxIoEqsPEWMuHbIJl2IDkB7QBMuh7MUiGG5LwVg7PHYqu5DMt%2bvj6vgi9qgpGSNr8mhAcpMDYr1TI2Eh0/qgPcoRJYu8ngDhAioNwfXRHn6Kgo4%2bGNCSFRMtEqpa35nvbLF548VEgjGWMEaCiX5iemTSJIk9VZEhaQP2ChDiVtoKYhlKRBwNEUB1P1bIRuVy4pqBRuX0dGEdy6HgbTA/3SwKcoUEI%2bJRiEDMC0pkyq%2bf6X7Rc2DNsGc83CUtS%2b/6UN0phhcArYkqyRZTbs%2bWboBVa52OEg5HCxURQEPtzVDhGP0dOI9JsdYgmIYe1MwZ2T0e5Vzeh5UkAXcVcmWNwHSUju0qb4cpWIUbqVArhZQsBbFSd19rHJnmvhGooFd46t6oiGrXaMMnFOv20iBfTYxj7IjNKPJr%2bBdCbKeAiGUsFkiMRcrixITqIFRhDbg9tUFeekqzvq%2bBGSbokrbiHO4bXHZPEjAkl%2bWe/INmpyYcdkW04YmC8MA6rahfG2C%2bTEpkJPnDYDtMNkS2wYXPiPlJCNoU%2b3msn%2bQklZCzSv/M2zT4SgUwJ%2bhnWsBgTyFpeLbF1sS7HWx3jlCvF0KtFkxic2AvMupUzH9kE7wqH%2bGYClsi8sK7NZKDp0qWLljNlD0kPJqP0cxefk7FL8ofTox0RU5xJxiSyRSieegWlYePc8tBPqa5MXPIR86pORB52WwN9DZFmeVwDw6chVklTaUWejl5Mkf6ty3DiUPOsNoonsnFypquzOv6Hur8mJj/AFOJ6Vwnp8wIAAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="1299" data-srcset="/assets/static/graph.82a2fbd.05d98aab579d28c11088e26a02cd1cba.png 480w, /assets/static/graph.1980bb8.05d98aab579d28c11088e26a02cd1cba.png 1299w" data-sizes="(max-width: 1299px) 100vw, 1299px" data-src="/assets/static/graph.1980bb8.05d98aab579d28c11088e26a02cd1cba.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/graph.1980bb8.05d98aab579d28c11088e26a02cd1cba.png" width="1299"></noscript></p>
<p>Podsumowując. Nie napracowaliśmy się tutaj za bardzo ale właśnie to było celem. Pokazanie jak jedną linią kodu można posumować ceny lub wyrysować wykres z danych, które pozornie są niedostępne, bo ich format nie jest tak oczywisty jak w przypadku uporządkowanych danych zapisanych w bazie o dobrze określonej strukturze.</p>
<p>Jeśli jesteś przedsiębiorcą i zainteresował Cię temat automatyzacji przetwarzania dokumentów umów się ze mną na darmową konsultację korzystając z linku ...</p>
<p>Jeśli jesteś programistą i chcesz z nami pracować ...</p>
<p>Jeśli chcesz poszerzyć swoją wiedzę i zapoznać się z narzędziami z których korzystaliśmy linki do nich znajdziesz poniżej...</p>
<p>Czyszczenie danych</p>
<p><a href="https://en.wikipedia.org/wiki/Data_cleansing" target="_blank" rel="nofollow noopener noreferrer">https://en.wikipedia.org/wiki/Data_cleansing</a></p>
<p>Pdf to Text Converter</p>
<p><a href="https://www.cyberciti.biz/faq/converter-pdf-files-to-text-format-command/" target="_blank" rel="nofollow noopener noreferrer">https://www.cyberciti.biz/faq/converter-pdf-files-to-text-format-command/</a></p>
<p>Przykład zastosowania xargs</p>
<p><a href="https://stackoverflow.com/questions/33141207/what-is-the-working-of-this-command-ls-xargs-i-t-cp-1" target="_blank" rel="nofollow noopener noreferrer">https://stackoverflow.com/questions/33141207/what-is-the-working-of-this-command-ls-xargs-i-t-cp-1</a></p>
<p>Chart - narzędzie do rysowania wykresów</p>
<p><a href="https://marianogappa.github.io/chart/" target="_blank" rel="nofollow noopener noreferrer">https://marianogappa.github.io/chart/</a></p>
<p>Paste - komenda do łączenia plików</p>
<p><a href="https://www.geeksforgeeks.org/paste-command-in-linux-with-examples/" target="_blank" rel="nofollow noopener noreferrer">https://www.geeksforgeeks.org/paste-command-in-linux-with-examples/</a></p>
<p>Przykładowe onelinery w Perlu</p>
<p><a href="https://www.rexegg.com/regex-perl-one-liners.html" target="_blank" rel="nofollow noopener noreferrer">https://www.rexegg.com/regex-perl-one-liners.html</a></p>
</div><footer class="flex flex-wrap pb-10 sm:pb-16"><div><a href="/tag/technical/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-colors duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
          technical
          </a><a href="/tag/bash/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-colors duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
          bash
          </a><a href="/tag/perl/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-colors duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
          perl
          </a><a href="/tag/pdf/" class="inline-block text-teal-400 hover:text-white hover:bg-teal-400 border border-teal-400 font-sans font-bold text-xs sm:text-sm px-4 py-2 mr-4 mb-2 rounded-full transition-colors duration-300"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" role="img" class="inline w-3 fill-current align-middle mr-1"><path d="M0 10V2l2-2h8l10 10-10 10L0 10zm4.5-4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"></path></svg>
          pdf
          </a></div><div class="flex flex-wrap items-center justify-center sm:justify-left border-t border-b border-gray-300 w-full mt-10 py-10 sm:px-16"><figure class="px-2 mb-1 sm:mb-0 w-full sm:w-1/5 flex justify-center"><a href="/author/Daniel%20Gustaw/"><img src="/images/authors/Daniel Gustaw.png" alt="Daniel Gustaw" width="100" class="rounded-full p-4 sm:p-0"></a></figure><div class="px-4 sm:w-4/5 text-center sm:text-left"><h4 class="font-sans font-bold text-lg sm:text-xl mb-2 sm:mb-4"><a href="/author/Daniel%20Gustaw/" class="text-black hover:text-gray-600 capitalize border-b-2 border-transparent transition-colors duration-300">Daniel Gustaw</a></h4><p class="leading-normal"><a href="/author/Daniel%20Gustaw/" class="text-blue-500 hover:text-blue-400 transition-colors duration-300">See all posts by Daniel Gustaw →</a></p></div></div></footer></article><footer class="text-gray-700 text-sm leading-normal flex flex-wrap justify-between mx-auto max-w-3xl px-6 sm:px-12 pb-8 sm:pb-10"><div class="w-full sm:w-1/2 mb-4 sm:mb-0"><p><a href="https://preciselab.io" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300">
          Precise Lab</a> by <a href="https://github.com/gustawdaniel" class="border-b border-transparent hover:border-gray-400 transition-colors
                                 duration-300">@gustawdaniel</a></p><p>Built with <a href="https://gridsome.org" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300">Gridsome</a> &amp; <a href="https://tailwindcss.com/" class="border-b border-transparent hover:border-gray-400 transition-colors duration-300">Tailwind CSS</a>.</p></div></footer></main></div>
    <script src="/assets/js/app.b21ea3c7.js" defer></script><script src="/assets/js/page--src--templates--post-vue.7752b335.js" defer></script>
  </body>
</html>
